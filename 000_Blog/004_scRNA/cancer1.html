<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bailey Andrew">
<meta name="dcterms.date" content="2023-01-19">
<meta name="description" content="Another scRNA paper">

<title>A Living Biobank of Ovarian Cancer – Data Acqusition – Lorem Ipsomething</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-10892d65c249a5d8f93b275ef5a48de5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="../../html_scripts/collapse.css">
<link rel="stylesheet" href="../../html_scripts/pretty_shortcuts.css">
<meta property="og:title" content="A Living Biobank of Ovarian Cancer – Data Acqusition – Lorem Ipsomething">
<meta property="og:description" content="Another scRNA paper">
<meta property="og:image" content="https://BaileyAndrew.github.io/Blog/000_Blog/004_scRNA/images/10x-protocol.png">
<meta property="og:site_name" content="Lorem Ipsomething">
<meta property="og:image:height" content="1210">
<meta property="og:image:width" content="1460">
<meta name="twitter:title" content="A Living Biobank of Ovarian Cancer – Data Acqusition – Lorem Ipsomething">
<meta name="twitter:description" content="Another scRNA paper">
<meta name="twitter:image" content="https://BaileyAndrew.github.io/Blog/000_Blog/004_scRNA/images/10x-protocol.png">
<meta name="twitter:image-height" content="1210">
<meta name="twitter:image-width" content="1460">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Lorem Ipsomething</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">A Living Biobank of Ovarian Cancer – Data Acqusition</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blog</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../staticposts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Static Posts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Puzzles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../500_Puzzles/bnv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Boulders in Valleys</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slideshowindex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slideshows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../otherblogs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other People’s Blogs</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-dataset" id="toc-the-dataset" class="nav-link active" data-scroll-target="#the-dataset">The Dataset</a>
  <ul class="collapse">
  <li><a href="#the-original-sample" id="toc-the-original-sample" class="nav-link" data-scroll-target="#the-original-sample">The Original Sample</a></li>
  <li><a href="#the-protocol" id="toc-the-protocol" class="nav-link" data-scroll-target="#the-protocol">The Protocol</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/BaileyAndrew/Blog/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Living Biobank of Ovarian Cancer – Data Acqusition</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Work</div>
    <div class="quarto-category">Omics</div>
    <div class="quarto-category">Useful</div>
    <div class="quarto-category">Paper Replication</div>
  </div>
  </div>

<div>
  <div class="description">
    Another scRNA paper
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bailey Andrew </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 19, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>I was recently reading the paper “<b style="color:#EB1960">A living biobank of ovarian cancer ex vivo models reveals profound mitotic heterogeneity</b>” <span class="citation" data-cites="ovarian-cancer-living-biobank">(<a href="#ref-ovarian-cancer-living-biobank" role="doc-biblioref">Nelson et al. 2020</a>)</span>, which I found when looking at <a href="https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-8559/experiment-design">this dataset</a> from the <b style="color:#EB1960">Single Cell Expression Atlas</b>. Let’s talk about this dataset.</p>
<section id="the-dataset" class="level1 page-columns page-full">
<h1>The Dataset</h1>
<section id="the-original-sample" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-original-sample">The Original Sample</h2>
<p>We’ve previously talked extensively about <b style="color:#A6A440">protocols</b>, but it’s also important to understand the original sample rather than just how it was processed!</p>
<p>Specifically, we want to know:</p>
<ul>
<li><b style="color:#C0CF96">Who</b> (was sampled)</li>
<li><b style="color:#C0CF96">Where</b> (were they sampled)</li>
<li><b style="color:#C0CF96">When</b> (were they sampled)</li>
<li><b style="color:#C0CF96">Why</b> (were they sampled)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li><b style="color:#C0CF96">What</b> (part of them was sampled)</li>
<li><b style="color:#C0CF96">How many</b> (were sampled)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
</ul>
<blockquote class="blockquote">
<p>To build a living biobank, we established a <b style="color:#537FBF">biopsy</b> pipeline, collecting samples from patients diagnosed with <b style="color:#A6A440">epithelial ovarian cancer</b> treated at the <b style="color:#EB1960">Christie Hospital</b>.</p>
<p>– <b style="color:#EB1960">“Establishing a living biobank of ovarian cancer ex vivo models” subsection, Results section, <span class="citation" data-cites="ovarian-cancer-living-biobank">(<a href="#ref-ovarian-cancer-living-biobank" role="doc-biblioref">Nelson et al. 2020</a>)</span></b></p>
</blockquote>
<p>This satisfies the <b style="color:#C0CF96">where</b> of our original question: <a href="https://www.christie.nhs.uk">Christie Hospital</a>:</p>
<blockquote class="blockquote">
<p><b style="color:#EB1960">The Christie NHS Foundation Trust</b></p>
<p><b style="color:#EB1960">Wilmslow Road</b></p>
<p><b style="color:#EB1960">Manchester</b></p>
<p><b style="color:#EB1960">M20 4BX</b></p>
<p><b style="color:#EB1960">United Kingdom</b></p>
</blockquote>
<p>It seems reasonable to assume that the grand majority of patients thus reside in <b style="color:#EB1960">the UK</b>, but we’ll have to go on a <b class="sidequests">Sidequest</b> to say much more. A <b style="color:#537FBF">biopsy</b> is when bits of you get removed to be examined clinically.</p>
<details>
<summary>
<b class="sidequests">Sidequest</b><b style="color:#EB1960">: The Christie NHS Foundation Trust</b>
</summary>
<p>It would be nice to say that the patients reside in the <b style="color:#EB1960">Manchester</b>, but this is not necessarily true. The feeding area for the hopsital may be larger than that, and also if <b style="color:#A6A440">epithelial ovarian cancer</b> is rare enough it might attract patients from further afield. What we’re interested in is <b style="color:#A6A440">catchment</b>; the locations from which people come into the hospital. Conveniently, <b style="color:#EB1960">The Christie</b> has <a href="https://www.christie.nhs.uk/patients-and-visitors/your-treatment-and-care/treatments/surgery/surgery-at-the-christie/tables-showing-surgical-procedures-and-effective-catchment-population">catchment info on their website</a>. It reveals that for <b style="color:#A6A440">gynaecological cancers</b> such as <b style="color:#A6A440">epithelial ovarian cancer</b>, 73% of the patients are from <b style="color:#EB1960">Manchester</b>, and 97% are from <b style="color:#EB1960">the North West</b>.</p>
<p>Surprisingly, <b style="color:#EB1960">the North West</b> has an official definition:</p>
<blockquote class="blockquote">
<p><b style="color:#EB1960">North West England</b> is one of nine official regions of <b style="color:#EB1960">England</b> and consists of the administrative counties of <b style="color:#EB1960">Cheshire</b>, <b style="color:#EB1960">Cumbria</b>, <b style="color:#EB1960">Greater Manchester</b>, <b style="color:#EB1960">Lancashire</b> and <b style="color:#EB1960">Merseyside</b></p>
<p>– <b style="color:#EB1960">Wikipedia, the most trustworthy of sources</b></p>
</blockquote>
</details>
<p>It also mostly answers the <b style="color:#C0CF96">who</b> question; patients with <b style="color:#A6A440">epithelial ovarian cancer</b>. In the pursuit of more details, we can refer to:</p>
<blockquote class="blockquote">
<p>Between <b style="color:#EB1960">May 2016</b> and <b style="color:#EB1960">June 2019</b>, we collected <b style="color:#C0CF96">312 samples</b> from patients with <b style="color:#A6A440">chemo-naïve</b> and <b style="color:#A6A440">relapsed disease</b>, either as <b style="color:#537FBF">solid biopsies</b> or as <b style="color:#537FBF">ascites</b> (<b style="color:#EB1960">Fig. 1a</b>)</p>
</blockquote>
<blockquote class="blockquote">
<p>Ten patients had <b style="color:#A6A440">HGSOC</b> while two had <b style="color:#A6A440">mucinous ovarian carcinoma</b>. <b style="color:#537FBF">Longitudinal biopsies</b> were collected from three patients.</p>
</blockquote>

<div class="no-row-height column-margin column-container"><div class="">
<p>An <b style="color:#537FBF">ascites</b> is an abnormal abdominal buildup of fluid.</p>
</div></div><p>Which conveniently answers <b style="color:#C0CF96">when</b> and <b style="color:#C0CF96">how many</b>. <b style="color:#EB1960">Fig 1</b> in the paper provides further specificity, revealing that there are 12 patients.</p>
<p>We should probably find out <b style="color:#C0CF96">what</b> and <b style="color:#C0CF96">why</b> but the <b style="color:#C0CF96">what</b> is presumably just “wherever the tumour is” and for <b style="color:#C0CF96">why</b> presumably patients were included if and only if they had <b style="color:#A6A440">epithelial ovarian cancer</b> at <b style="color:#EB1960">The Christie</b>.</p>
</section>
<section id="the-protocol" class="level2">
<h2 class="anchored" data-anchor-id="the-protocol">The Protocol</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/ovarian-fig-1b.png" class="img-fluid figure-img"></p>
<figcaption>From <span class="citation" data-cites="ovarian-cancer-living-biobank">Nelson et al. (<a href="#ref-ovarian-cancer-living-biobank" role="doc-biblioref">2020</a>)</span>, not my own work.</figcaption>
</figure>
</div>
<p>They used <b style="color:#EB1960">10x Genomics Protocol <i>CG000183 Rev A</i></b> <span class="citation" data-cites="10x-protocol">(<a href="#ref-10x-protocol" role="doc-biblioref"><span>“Chromium Single Cell 3’ Reagent Kits V3 User Guide”</span> 2018</a>)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/10x-protocol.png" class="img-fluid figure-img"></p>
<figcaption>Overview of the protocol. Not my own work</figcaption>
</figure>
</div>
<p>In brief:</p>
<blockquote class="blockquote">
<p>The primer contains:</p>
<ul>
<li><p>an Illumina TruSeq Read 1 (read 1 sequencing primer)</p></li>
<li><p>16 nt 10x Barcode</p></li>
<li><p>12 nt <b style="color:#A6A440">unique molecular identifier (UMI)</b></p></li>
<li><p>30 nt poly(dT) sequence</p></li>
</ul>
</blockquote>
<blockquote class="blockquote">
<p>Barcoded, full-length <b style="color:#A6A440">cDNA</b> is amplified via <b style="color:#537FBF">PCR</b> to generate sufficient mass for library construction.</p>
</blockquote>
</section>
<section id="data-exploration" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<p>Now that we’ve taken a peak at the data collection details, let’s explore the actual data. I’ve downloaded the raw counts data from then <b style="color:#EB1960">Single Cell Expression Atlas</b>.</p>
<div id="7b71d0cc-9374-465a-9bb2-7c189a47716b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>file.path <span class="ot">=</span> <span class="st">'./localdata/E-MTAB-8559-quantification-raw-files/'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="04d75565-f091-4dcd-b2c3-0d9667d9bea5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>raw.counts <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">readMM</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-MTAB-8559.aggregated_filtered_counts.mtx'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep=</span><span class="st">''</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="bca01665-6dbf-45a6-8e66-0f2c278d6eeb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(raw.counts)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>23284</li><li>19880</li></ol>
</div>
</div>
<div id="4ceefc4a-c351-4bb3-b5ac-3a1dc5e993be" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>row.info <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-MTAB-8559.aggregated_filtered_counts.mtx_rows'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep=</span><span class="st">''</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">FALSE</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Ensembl.ID"</span>, <span class="st">"Redundant"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(row.info[<span class="st">'Ensembl.ID'</span>] <span class="sc">==</span> row.info[<span class="st">'Redundant'</span>])) {</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I don't understand why these datasets tend to write</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the same name twice in each row???</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Both columns are indeed the same"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicate column</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>row.info <span class="ot">&lt;-</span> row.info[<span class="st">'Ensembl.ID'</span>]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(row.info)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Both columns are indeed the same"</code></pre>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small">
<caption>A data.frame: 6 × 1</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Ensembl.ID</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">1</th>
<td>ENSG00000000003</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">2</th>
<td>ENSG00000000419</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">3</th>
<td>ENSG00000000457</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">4</th>
<td>ENSG00000000460</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">5</th>
<td>ENSG00000000938</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">6</th>
<td>ENSG00000000971</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="1b4ff96e-bc0f-4d41-a4c6-c25c3abba3a7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>col.info <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-MTAB-8559.aggregated_filtered_counts.mtx_cols'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep=</span><span class="st">''</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">'-'</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">'Sample.Info'</span>, <span class="st">'Cell.Barcode'</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>col.info[<span class="st">'Full.ID'</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    col.info,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="co"># Rows</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(row) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">'Sample.Info'</span>],</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">'Cell.Barcode'</span>],</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep=</span><span class="st">'-'</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(col.info)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small">
<caption>A data.frame: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Sample.Info</th>
<th data-quarto-table-cell-role="th" scope="col">Cell.Barcode</th>
<th data-quarto-table-cell-role="th" scope="col">Full.ID</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">1</th>
<td>SAMEA6492740</td>
<td>AAACCCACAGTTAGGG</td>
<td>SAMEA6492740-AAACCCACAGTTAGGG</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">2</th>
<td>SAMEA6492740</td>
<td>AAACCCACATGTGTCA</td>
<td>SAMEA6492740-AAACCCACATGTGTCA</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">3</th>
<td>SAMEA6492740</td>
<td>AAACCCAGTCGCATGC</td>
<td>SAMEA6492740-AAACCCAGTCGCATGC</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">4</th>
<td>SAMEA6492740</td>
<td>AAACCCAGTCTTTCAT</td>
<td>SAMEA6492740-AAACCCAGTCTTTCAT</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="row">5</th>
<td>SAMEA6492740</td>
<td>AAACCCATCCGTGTCT</td>
<td>SAMEA6492740-AAACCCATCCGTGTCT</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" scope="row">6</th>
<td>SAMEA6492740</td>
<td>AAACCCATCCTCTCTT</td>
<td>SAMEA6492740-AAACCCATCCTCTCTT</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cc15444a-db69-4467-bb39-33e56e278569" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>exp.design.table <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'./localdata/ExpDesign-E-MTAB-8559.tsv'</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We’ve loaded the data now; interestingly, the data only seems to be from 4 individuals, not 12 as previously mentioned!</p>
<div id="510f9cbc-e717-414c-8086-e1cefd21c0e8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(col.info<span class="sc">$</span>Sample.Info)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(exp.design.table<span class="sc">$</span>Sample.Characteristic.individual.)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'SAMEA6492740'</li><li>'SAMEA6492741'</li><li>'SAMEA6492742'</li><li>'SAMEA6492743'</li></ol>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'38b'</li><li>'59'</li><li>'74-1'</li><li>'79'</li></ol>
</div>
</div>
<p>This is because the <b style="color:#537FBF">scRNA-seq</b> data is only one of may experiments they’ve run on their dataset:</p>
<blockquote class="blockquote">
<p>To extend this analysis, we analysed <b style="color:#A6A440">OCMs</b> <strong style="color:#C0CF96">38b</strong>, <strong style="color:#C0CF96">59</strong>, <strong style="color:#C0CF96">74–1</strong> and <strong style="color:#C0CF96">79</strong> using a <b style="color:#EB1960">10x Genomics platform</b>.</p>
<p>– <span class="citation" data-cites="ovarian-cancer-living-biobank">(<a href="#ref-ovarian-cancer-living-biobank" role="doc-biblioref">Nelson et al. 2020</a>)</span></p>
</blockquote>

<div class="no-row-height column-margin column-container"><div class="">
<p><b style="color:#A6A440">OCM</b> stands for <b style="color:#A6A440">ovarian cancer models</b>; which is the name for the cultures that we are studying.</p>
</div></div><p>We can also see that the data from our counts matrix is not necessarily integer, so we need to know what the counts are actually representing.</p>
<div id="6fff81ed-ba85-4d38-9313-93e397c2ee6f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>raw.counts[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>10 x 10 sparse Matrix of class "dgTMatrix"
                           
 [1,] . . . . 1 . . . .   .
 [2,] . 1 1 . . . . . 2.0 .
 [3,] . . . . . 1 . . .   .
 [4,] . . . . . . . . .   .
 [5,] . . . . . . . . .   .
 [6,] . . . . . . . 1 .   .
 [7,] . . . 1 . . . . .   .
 [8,] . . . . . . . . .   .
 [9,] . . . . . . . . .   .
[10,] . 2 . . 1 . . . 0.5 .</code></pre>
</div>
</div>
<details>
<summary>
<b class="false-starts">False Start</b><b style="color:#C0CF96">: Log Transformed?</b>
</summary>
<p>One possible answer is that these “raw” counts have been log-transformed:</p>
<blockquote class="blockquote">
<p>Raw counts of the remaining cells were then <b style="color:#537FBF">normalised</b> using the <b style="color:#537FBF">deconvolution-based method</b> and then <b style="color:#537FBF">log transformed</b>.</p>
</blockquote>
<p>But the smallest base that would possibly be used would be 2, and there’s no way <span class="math inline">\(2^{2772}\)</span> genes were observed:</p>
<div id="9b3224f6-9d98-4bd3-9ee4-dede8bcc7a98" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(raw.counts)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
2771.9734
</div>
</div>
</details>
<p>According to <a href="https://bioinformatics.stackexchange.com/questions/4993/article-geo-gives-counts-that-are-not-integers-should-umi-counts-be-integers">the internet</a>, sometimes values are stated in terms of “expected counts”, since there is luck in RNA sequencing as to how easy it is to paste the reads back together. Looking into the <b style="color:#EB1960">Single Cell Expression Atlas</b>’s section on Supplementary Information, <span class="citation" data-cites="ovarian-cancer-living-biobank">Nelson et al. (<a href="#ref-ovarian-cancer-living-biobank" role="doc-biblioref">2020</a>)</span> used <b style="color:#EB1960">Alevin v1.5.1</b> <span class="citation" data-cites="alevin">(<a href="#ref-alevin" role="doc-biblioref">Srivastava et al. 2019</a>)</span>, a tool to produce <strong style="color:#C0CF96">estimated</strong> counts. Thus it seems reasonable to conclude that the counts represent estimated counts.</p>
<p>That’s all for now - next time, we’ll try to reproduce <b style="color:#EB1960">Figure 5</b> from the paper.</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-10x-protocol" class="csl-entry" role="listitem">
<span>“Chromium Single Cell 3’ Reagent Kits V3 User Guide.”</span> 2018. 10x Genomics. <a href="https://assets.ctfassets.net/an68im79xiti/51xGuiJhVKOeIIceW88gsQ/1db2c9b5c9283d183ff4599fb489a720/CG000183_ChromiumSingleCell3__v3_UG_Rev-A.pdf">https://assets.ctfassets.net/an68im79xiti/51xGuiJhVKOeIIceW88gsQ/1db2c9b5c9283d183ff4599fb489a720/CG000183_ChromiumSingleCell3__v3_UG_Rev-A.pdf</a>.
</div>
<div id="ref-ovarian-cancer-living-biobank" class="csl-entry" role="listitem">
Nelson, Louisa, Anthony Tighe, Anya Golder, Samantha Littler, Bjorn Bakker, Daniela Moralli, Syed Murtuza Baker, et al. 2020. <span>“A Living Biobank of Ovarian Cancer Ex Vivo Models Reveals Profound Mitotic Heterogeneity.”</span> <em>Nature Communications</em> 11 (1): 822. <a href="https://doi.org/10.1038/s41467-020-14551-2">https://doi.org/10.1038/s41467-020-14551-2</a>.
</div>
<div id="ref-alevin" class="csl-entry" role="listitem">
Srivastava, A., L. Malik, T. Smith, I. Sudbery, and R. Patro. 2019. <span>“<span class="nocase"><span>A</span>levin efficiently estimates accurate gene abundances from dsc<span>R</span><span>N</span><span>A</span>-seq data</span>.”</span> <em>Genome Biol</em> 20 (1): 65.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>As in what were the inclusion/exclusion criteria<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There’s another “<b style="color:#C0CF96">How</b>”, as in “how were they sampled?”, but that’s a question for once we start looking at the <b style="color:#A6A440">protocol</b>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script>
    // Remove background
    elements = document.querySelectorAll('[id=clean-collapse]').forEach(
        function(element) {
            element.classList.remove("callout-style-default");
        }
    )
    
    // Add arrow to front to signify dropdownyness
    arrow = "▶";
    elements = document.querySelectorAll('.callout-caption-container').forEach(
        function(element) {
            element.innerHTML = arrow + element.innerHTML;
        }
    )
</script>
<script src="https://giscus.app/client.js" data-repo="baileyandrew/blog" data-repo-id="R_kgDOInJwKg" data-category="Announcements" data-category-id="DIC_kwDOInJwKs4CTGOQ" data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark_protanopia" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script>
<!--
Assuming `_quarto.yml` has `navbar: pinned: true`,
this will make it so that the navbar scrolls with the rest of the website.
-->
<script>
    document.getElementById('quarto-header').classList.remove('fixed-top');
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/BaileyAndrew\.github\.io\/Blog");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/BaileyAndrew/Blog/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>