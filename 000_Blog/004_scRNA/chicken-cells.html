<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bailey Andrew">
<meta name="dcterms.date" content="2023-02-06">
<meta name="description" content="Life lesson: 🐔 ≠ 🐓">

<title>Lorem Ipsomething - A tale of two chickens</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="../../html_scripts/collapse.css">
<link rel="stylesheet" href="../../html_scripts/pretty_shortcuts.css">
<meta property="og:title" content="Lorem Ipsomething - A tale of two chickens">
<meta property="og:description" content="Life lesson: 🐔 ≠ 🐓">
<meta property="og:image" content="https://BaileyAndrew.github.io/Blog/000_Blog/004_scRNA/images/a-tale-of-two-chickens.png">
<meta property="og:site-name" content="Lorem Ipsomething">
<meta property="og:image:height" content="156">
<meta property="og:image:width" content="160">
<meta name="twitter:title" content="Lorem Ipsomething - A tale of two chickens">
<meta name="twitter:description" content="Life lesson: 🐔 ≠ 🐓">
<meta name="twitter:image" content="https://BaileyAndrew.github.io/Blog/000_Blog/004_scRNA/images/a-tale-of-two-chickens.png">
<meta name="twitter:image-height" content="156">
<meta name="twitter:image-width" content="160">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Lorem Ipsomething</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">A tale of two chickens</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../blog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blog</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../staticposts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Static Posts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Puzzles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../500_Puzzles/bnv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Boulders in Valleys</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slideshowindex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slideshows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../otherblogs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other People’s Blogs</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#but-why" id="toc-but-why" class="nav-link active" data-scroll-target="#but-why">But why?</a></li>
  <li><a href="#tracking-the-history-of-the-events" id="toc-tracking-the-history-of-the-events" class="nav-link" data-scroll-target="#tracking-the-history-of-the-events">Tracking the history of the events</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/BaileyAndrew/Blog/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A tale of two chickens</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Work</div>
    <div class="quarto-category">Omics</div>
    <div class="quarto-category">Useful</div>
    <div class="quarto-category">Paper Replication</div>
  </div>
  </div>

<div>
  <div class="description">
    Life lesson: 🐔 ≠ 🐓
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bailey Andrew </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>Today we’ll be looking at the paper “A single-cell transcriptomic atlas of the developing chicken limb”, by <span class="citation" data-cites="chicken-cells">Feregrino et al. (<a href="#ref-chicken-cells" role="doc-biblioref">2019</a>)</span> - specifically, we’ll use <a href="https://www.ebi.ac.uk/gxa/sc/experiments/E-CURD-13/downloads">this dataset from the Single Cell Expression Atlas</a>. However, we’re not actually gonna read their paper, we’re just gonna do random stuff!</p>
<p><b class="sidequests">Spoilers</b>: We don’t get much work done, due to a mystery involving chicken breeds in Ensembl.</p>
<details>
<summary style="color:#C0CF96">
Loading the Data
</summary>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SingleCellExperiment)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biomaRt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>file.path <span class="ot">=</span> <span class="st">'./localdata/Datasets/E-CURD-13/'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>counts.mat <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">readMM</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13-quantification-raw-files/'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13.aggregated_filtered_counts.mtx'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(counts.mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>13645</li><li>7688</li></ol>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>counts.rows <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13-quantification-raw-files/'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13.aggregated_filtered_counts.mtx_rows'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">FALSE</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>V1</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>counts.cols <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13-quantification-raw-files/'</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E-CURD-13.aggregated_filtered_counts.mtx_cols'</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">FALSE</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>V1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>meta.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        file.path,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ExpDesign-E-CURD-13.tsv'</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names=</span><span class="st">'Assay'</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(meta.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'Sample.Characteristic.organism.'</li><li>'Sample.Characteristic.Ontology.Term.organism.'</li><li>'Sample.Characteristic.age.'</li><li>'Sample.Characteristic.Ontology.Term.age.'</li><li>'Sample.Characteristic.developmental.stage.'</li><li>'Sample.Characteristic.Ontology.Term.developmental.stage.'</li><li>'Sample.Characteristic.organism.part.'</li><li>'Sample.Characteristic.Ontology.Term.organism.part.'</li><li>'Sample.Characteristic.sampling.site.'</li><li>'Sample.Characteristic.Ontology.Term.sampling.site.'</li><li>'Sample.Characteristic.genotype.'</li><li>'Sample.Characteristic.Ontology.Term.genotype.'</li><li>'Sample.Characteristic.disease.'</li><li>'Sample.Characteristic.Ontology.Term.disease.'</li><li>'Factor.Value.replicate.'</li><li>'Factor.Value.Ontology.Term.replicate.'</li><li>'Factor.Value.inferred.cell.type...ontology.labels.'</li><li>'Factor.Value.Ontology.Term.inferred.cell.type...ontology.labels.'</li></ol>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(counts.mat) <span class="ot">&lt;-</span> counts.rows</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts.mat) <span class="ot">&lt;-</span> counts.cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure the metadata is lined up with the count matrix</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(meta.data<span class="sc">$</span>Assay, <span class="fu">colnames</span>(counts.mat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
TRUE
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">SingleCellExperiment</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">assays=</span><span class="fu">list</span>(<span class="at">counts=</span>counts.mat),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData=</span>meta.data</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sce</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>class: SingleCellExperiment 
dim: 13645 7688 
metadata(0):
assays(1): counts
rownames(13645): ENSGALG00000000003 ENSGALG00000000011 ...
  ENSGALG00000055127 ENSGALG00000055132
rowData names(0):
colnames(7688): SAMN11526603-AAAAAAATTCAG SAMN11526603-AAAAACAAGTAG ...
  SAMN11526603-TTTTTTTGTGAG SAMN11526603-TTTTTTTTTTTT
colData names(18): Sample.Characteristic.organism.
  Sample.Characteristic.Ontology.Term.organism. ...
  Factor.Value.inferred.cell.type...ontology.labels.
  Factor.Value.Ontology.Term.inferred.cell.type...ontology.labels.
reducedDimNames(0):
mainExpName: NULL
altExpNames(0):</code></pre>
</div>
</div>
</details>
<p>I wanted to perform QC using mitochondrial genes. This should have been as easy as reusing my code for humans with a few tweaks to look for chicken genes instead. However, when I try to use <code>biomaRt</code> I get no result.</p>
<div class="cell" data-tags="[]" data-execution_count="86">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mart <span class="ot">&lt;-</span> <span class="fu">useDataset</span>(<span class="st">"ggallus_gene_ensembl"</span>, <span class="fu">useMart</span>(<span class="st">"ensembl"</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>gene.to.symbol.map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters=</span><span class="st">"ensembl_gene_id"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">attributes=</span><span class="fu">c</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ensembl_gene_id"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"hgnc_symbol"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">rownames</span>(sce),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mart=</span>mart</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>gene.to.symbol.map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 0 × 2</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">ensembl_gene_id</th>
<th data-quarto-table-cell-role="th" scope="col">hgnc_symbol</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;lgl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;lgl&gt;</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
<p>So I went directly to the <code>biomaRt</code> <a href="https://www.ensembl.org/biomart/martview/3d63e0dabdacc8dc33bd4bba9ed2130a">web interface</a>, and searched for a gene I knew was in the dataset: <code>ENSGALG00000000003</code></p>
<p><img src="./images/no-003.png" class="img-fluid"></p>
<p>However, you can see that in the top left corner it reports no results! If you look closely, you can see that the example search is with <code>ENSGALG00010000002</code>, which does have results - and in fact adding 10,000,000 to gene numbers tends to create a valid findable gene:</p>
<p><img src="./images/yes-003.png" class="img-fluid"></p>
<p>These genes don’t seem to be related to eachother though.</p>
<p>If we filter for mitochondrial genes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/filters.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Like this.</figcaption>
</figure>
</div>
<p>Then we do get results:</p>
<p><img src="./images/found-mitos.png" class="img-fluid"></p>
<p>Which all have ids greater than 10,000,000. This list is not comprehensive, I can find (off biomaRt) another mitochondrial gene, whose id is less than 10,000,000:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/a-missed-mito.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">ENSGALG00000031197</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>The avian genome encodes the same set of genes (13 proteins, 2 rRNAs and 22 tRNAs) as do other vertebrate mitochondrial DNAs and is organized in a very similar economical fashion.</p>
<p>– “Sequence and gene organization of the chicken mitochondrial genome: A novel gene order in higher vertebrates”, <span class="citation" data-cites="chicken-mitochondria">Desjardins and Morais (<a href="#ref-chicken-mitochondria" role="doc-biblioref">1990</a>)</span></p>
</blockquote>
<p>From the above, we can see that there should be 24 mt-rRNA and mt-tRNA in total, which is in fact what we find with biomaRt! (The previous image only shows 10, but that’s because it only shows 10 per page - the total amount found was 24).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/more-than-million.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The entire mitochondrial genome when viewing it starting from a gene larger than 10,000,000.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/less-than-million.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The entire mitochondrial genome when viewing it starting from a gene less than 10,000,000.</figcaption>
</figure>
</div>
<p>These two images seem to conclusively show that the gene sets are different; the genes are in a similar place but have different names between the two tracks.</p>
<p>From this, we can hypothesize that the ids less than 10,000,000 are out of date, presenting some frustration for using the data we have. Can we prove it?</p>
<p><img src="./images/no-change.png" class="img-fluid"></p>
<p>No: the gene has never changed its ID (which is a good thing for sanity purposes but is not ideal for this specific confusion).</p>
<p>However, it seems like there are multiple chicken genomes in Ensembl:</p>
<p><img src="./images/chickens.png" class="img-fluid"></p>
<p>This proves, conclusively, that there are at least two breeds of chicken. And I was looking at the wrong one.</p>
<p>The question then becomes - how do we actually find the right one? We can get a list of all the possible biomart-queryable datasets:</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all.datasets <span class="ot">&lt;-</span> <span class="fu">listDatasets</span>(<span class="at">mart =</span> mart)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>all.datasets[<span class="dv">70</span><span class="sc">:</span><span class="dv">80</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 11 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">dataset</th>
<th data-quarto-table-cell-role="th" scope="col">description</th>
<th data-quarto-table-cell-role="th" scope="col">version</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">70</td>
<td>fheteroclitus_gene_ensembl</td>
<td>Mummichog genes (Fundulus_heteroclitus-3.0.2)</td>
<td>Fundulus_heteroclitus-3.0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">71</td>
<td>gaculeatus_gene_ensembl</td>
<td>Stickleback genes (BROAD S1)</td>
<td>BROAD S1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">72</td>
<td>gevgoodei_gene_ensembl</td>
<td>Goodes thornscrub tortoise genes (rGopEvg1_v1.p)</td>
<td>rGopEvg1_v1.p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">73</td>
<td>gfortis_gene_ensembl</td>
<td>Medium ground-finch genes (GeoFor_1.0)</td>
<td>GeoFor_1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">74</td>
<td>ggallus_gene_ensembl</td>
<td>Chicken genes (bGalGal1.mat.broiler.GRCg7b)</td>
<td>bGalGal1.mat.broiler.GRCg7b</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">75</td>
<td>ggorilla_gene_ensembl</td>
<td>Gorilla genes (gorGor4)</td>
<td>gorGor4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">76</td>
<td>gmorhua_gene_ensembl</td>
<td>Atlantic cod genes (gadMor3.0)</td>
<td>gadMor3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">77</td>
<td>hburtoni_gene_ensembl</td>
<td>Burton's mouthbrooder genes (AstBur1.0)</td>
<td>AstBur1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">78</td>
<td>hcomes_gene_ensembl</td>
<td>Tiger tail seahorse genes (H_comes_QL1_v1)</td>
<td>H_comes_QL1_v1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">79</td>
<td>hgfemale_gene_ensembl</td>
<td>Naked mole-rat female genes (HetGla_female_1.0)</td>
<td>HetGla_female_1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">80</td>
<td>hhucho_gene_ensembl</td>
<td>Huchen genes (ASM331708v1)</td>
<td>ASM331708v1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>But this does not contain the option to choose anything other than <code>bGalGal1.mat.broiler.GRCg7b</code>, the paternal White leghorn layer chicken.</p>
<p>Online, we can find an archived version of <code>biomaRt</code> that grants access:</p>
<p><img src="./images/archived-chicken.png" class="img-fluid"></p>
<p>And the results line up with prior expectations.</p>
<p>So if we use the <code>biomaRt</code> R interface with an archived host, maybe we can get the Red Junglefowl’s genes?</p>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mart.archive <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">"ensembl"</span>, <span class="at">host=</span><span class="st">"https://apr2022.archive.ensembl.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>all.datasets <span class="ot">&lt;-</span> <span class="fu">listDatasets</span>(<span class="at">mart =</span> mart.archive)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>all.datasets[<span class="dv">70</span><span class="sc">:</span><span class="dv">80</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 11 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">dataset</th>
<th data-quarto-table-cell-role="th" scope="col">description</th>
<th data-quarto-table-cell-role="th" scope="col">version</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">70</td>
<td>fheteroclitus_gene_ensembl</td>
<td>Mummichog genes (Fundulus_heteroclitus-3.0.2)</td>
<td>Fundulus_heteroclitus-3.0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">71</td>
<td>gaculeatus_gene_ensembl</td>
<td>Stickleback genes (BROAD S1)</td>
<td>BROAD S1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">72</td>
<td>gevgoodei_gene_ensembl</td>
<td>Goodes thornscrub tortoise genes (rGopEvg1_v1.p)</td>
<td>rGopEvg1_v1.p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">73</td>
<td>gfortis_gene_ensembl</td>
<td>Medium ground-finch genes (GeoFor_1.0)</td>
<td>GeoFor_1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">74</td>
<td>ggallus_gene_ensembl</td>
<td>Chicken genes (GRCg6a)</td>
<td>GRCg6a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">75</td>
<td>ggorilla_gene_ensembl</td>
<td>Gorilla genes (gorGor4)</td>
<td>gorGor4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">76</td>
<td>gmorhua_gene_ensembl</td>
<td>Atlantic cod genes (gadMor3.0)</td>
<td>gadMor3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">77</td>
<td>hburtoni_gene_ensembl</td>
<td>Burton's mouthbrooder genes (AstBur1.0)</td>
<td>AstBur1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">78</td>
<td>hcomes_gene_ensembl</td>
<td>Tiger tail seahorse genes (H_comes_QL1_v1)</td>
<td>H_comes_QL1_v1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">79</td>
<td>hgfemale_gene_ensembl</td>
<td>Naked mole-rat female genes (HetGla_female_1.0)</td>
<td>HetGla_female_1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">80</td>
<td>hhucho_gene_ensembl</td>
<td>Huchen genes (ASM331708v1)</td>
<td>ASM331708v1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Victory! <code>GRCg6a</code> is the Red Junglefowl.</p>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mart.archive <span class="ot">&lt;-</span> <span class="fu">useDataset</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ggallus_gene_ensembl"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">useMart</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ensembl"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">host=</span><span class="st">"https://apr2022.archive.ensembl.org"</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>gene.to.symbol.map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">filters=</span><span class="st">"ensembl_gene_id"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">attributes=</span><span class="fu">c</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ensembl_gene_id"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"hgnc_symbol"</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">rownames</span>(sce),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mart=</span>mart.archive</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gene.to.symbol.map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 6 × 2</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">ensembl_gene_id</th>
<th data-quarto-table-cell-role="th" scope="col">hgnc_symbol</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>ENSGALG00000000003</td>
<td>PANX2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>ENSGALG00000000011</td>
<td>C10orf88</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>ENSGALG00000000038</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>ENSGALG00000000044</td>
<td>WFIKKN1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">5</td>
<td>ENSGALG00000000055</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">6</td>
<td>ENSGALG00000000059</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Double victory!</p>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode R code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gene.to.symbol.map[</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        gene.to.symbol.map[<span class="st">"hgnc_symbol"</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x) <span class="fu">grepl</span>(<span class="st">"^MT-"</span>, x)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 2 × 2</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">ensembl_gene_id</th>
<th data-quarto-table-cell-role="th" scope="col">hgnc_symbol</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">9151</td>
<td>ENSGALG00000032142</td>
<td>MT-CO1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">11684</td>
<td>ENSGALG00000043768</td>
<td>MT-ND2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All that for just two genes. Oh well. We’ll analyze this dataset in a future blog post.</p>
<p><b style="color:#EB1960">As a learning experience, I would recommend always specifying a specific Ensembl version when querying <code>biomaRt</code></b>, since evidently code that used to work will break if they change the default breed.</p>
<p>Also, it’s a bit frustrating that I can’t specify the breed in <code>biomaRt</code>, because Ensembl still has the data for the other breed - it’s just for some reason not accessible via <code>biomaRt</code> which only presents a single breed to query.</p>
<section id="but-why" class="level2">
<h2 class="anchored" data-anchor-id="but-why">But why?</h2>
<p>I’m left with one question: why are there two chickens? Why is the junglefowl no longer on modern BioMart? What is their relation? (Ahhhhhhhhhhhh)</p>
<p>I did manage to find a <a href="https://www.ed.ac.uk/roslin/national-avian-research-facility/avian-resources/poultry-lines/white-leghorn">summary of some chicken breeds</a>, but it did not resolve my question.</p>
<p>To investigate further, I went through the history of the Ensembl versions:</p>
<ul>
<li><a href="http://oct2022.archive.ensembl.org/Gallus_gallus/Info/Index">Version 108</a> (current, October 2022): Default chicken is <code>bGalGal1.mat.broiler.GRCg7b</code>
<ul>
<li>But when we look at the <a href="http://oct2022.archive.ensembl.org/Gallus_gallus/Info/Breeds">chicken breeds page</a> they list it as <code>bGalGal1.pat.whiteleghornlayer.GRCg7w</code></li>
</ul></li>
<li><a href="http://jul2022.archive.ensembl.org/Gallus_gallus/Info/Index">Version 107</a> (July 2022): Default chicken is <code>bGalGal1.mat.broiler.GRCg7b</code>
<ul>
<li>Although in this version they call it the “maternal broiler”</li>
<li>And when we look at the <a href="http://jul2022.archive.ensembl.org/Gallus_gallus/Info/Breeds">chicken breeds page</a> they list it as <code>bGalGal1.pat.whiteleghornlayer.GRCg7w</code></li>
</ul></li>
<li><a href="http://apr2022.archive.ensembl.org/Gallus_gallus/Info/Index">Version 106</a> (April 2022): Default chicken is <code>GRCg6a</code>
<ul>
<li>And there is no chicken breeds page</li>
</ul></li>
</ul>
<p>It seems like the chicken breeds pages don’t list the default breed on it, and that all of the genes for <code>GRCg7w</code> are listed with IDs beginning with 00015 (<a href="https://www.ensembl.org/Gallus_gallus_GCA_016700215.2/Gene/Summary?db=core;g=ENSGALG00015014615;r=1:140692888-140816960;t=ENSGALT00015035601">such as here</a>). This is in contrast with the 00010 beginning for <code>GRCg7b</code> and <code>GRCg6a</code>.</p>
<p><b style="color:#EB1960">Thus, we can say this:</b></p>
<ul>
<li>There are three chickens in play<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, <code>GRCg6a</code> (“red junglefowl”), <code>GRCg7w</code> (“white leghorn”), and <code>GRCg7b</code> (“maternal broiler”).</li>
<li><code>GRCg7b</code> (“maternal broiler”) is the current default</li>
<li><code>GRCg6a</code> (“red junglefowl”) used to be the default back in version 106</li>
</ul>
<p>Looking up “maternal broiler”, I am able to find <a href="https://www.ncbi.nlm.nih.gov/assembly/GCF_016699485.2/">this page</a> talking about the <code>bGalGal1.mat.broiler.GRCg7b</code> genome. It lists its breed as specifically being:</p>
<blockquote class="blockquote">
<p>Breed: Cross of Broiler mother + white leghorn layer father</p>
</blockquote>
<p>This only deepens the mystery. Why did we go from Red Junglefowl to Maternal Broiler? How does the White Leghorn come into the picture, and is it related to why <code>GRCg7w</code> is a crossbreed?</p>
<blockquote class="blockquote">
<p>The chicken has been the most studied bird. It serves as a model organism for basic and biomedical science, and is one of the most commonly consumed food sources for humans.</p>
<p>This trio of samples was collected to create a high-quality reference genome for two haplotypes.</p>
<p><b style="color:#537FBF">The female offspring (<code>bGalGal1</code>) is a cross between a modern broiler breeder mother (<code>bGalGal2</code>) and white Leghorn father (<code>bGalGal3</code>).</b></p>
<p>Breeding and sample collection was conducted by Nick Anthony at the University of Arkansas, in coordination with Wesley Warren, Ron Okimoto, Hans Cheng, and Rachel Hawken.</p>
<p>Blood from these samples were used to create high-quality reference genome assemblies of each haplotype, coordinated by Erich Jarvis, Wesley Warren, and Olivier Fedrigo, at the Rockefeller University Vertebrate Genome Lab, as part of the Vertebrate Genomes Project (VGP) and the Genome Reference Consortium (GRC).</p>
<p>– <a href="https://www.ncbi.nlm.nih.gov/data-hub/genome/GCF_016699485.2/">Webpage</a> for <code>GRCg7b</code></p>
</blockquote>
<p>The webpage identifies <code>GRCg7b</code> as coming from <code>bGalGal3</code> and <code>GRCg7w</code> as coming from <code>bGalGal2</code>.</p>
<p>It seems <code>bGalGal1</code> does not have its own assembly, as <a href="https://www.ncbi.nlm.nih.gov/data-hub/genome/?taxon=9031">the list of chicken assemblies</a> does not include it. The most information I can get as to <code>bGalGal1</code> is <a href="https://www.ncbi.nlm.nih.gov/biosample/14342210">on its sample page</a>, which is significantly less detailed than <a href="https://www.ncbi.nlm.nih.gov/biosample/SAMN15960293/">its parent’s</a>. As an aside, it seems like a lot of new chicken assemblies were made in 2022, which may be interesting for the future.</p>
<p>According to <a href="https://www.ncbi.nlm.nih.gov/assembly/GCF_016700215.1/">the page</a> for <code>bGalGal3</code>, the <code>GRCg7w</code> assembly has been updated to <code>GRCg7w_WZ</code>. I believe this did not require getting more real-world data, but rather was a re-sequencing (re-assembling) of the collected data.</p>
</section>
<section id="tracking-the-history-of-the-events" class="level2">
<h2 class="anchored" data-anchor-id="tracking-the-history-of-the-events">Tracking the history of the events</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/chicken-history.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">This shows the history of the assembly chosen for the chicken, procured from <a href="https://www.ensembl.org/info/website/archives/assembly.html">here</a></figcaption>
</figure>
</div>
<p>On the Ensembl blog, we can get a changelog of what has happened:</p>
<blockquote class="blockquote">
<h3 class="anchored">
New Assemblies and/or Annotation
</h3>
<h4 class="anchored">
Vertebrates
</h4>
<ul>
<li>Reannotation of the reference assembly for pig (<code>Sscrofa11.1</code>)</li>
<li><b style="color:#C0CF96">Reannotation of chicken assembly</b> (<code>GRCg6a</code>)</li>
<li><b style="color:#C0CF96">Annotation of 2 new GRC chicken assemblies</b> (<code>GRCg7w</code> <b style="color:#C0CF96">and</b> <code>GRCg7b</code>)</li>
<li><b style="color:#C0CF96">Chicken reference will be changed from</b> <code>GRCg6a</code> <b style="color:#C0CF96">to</b> <code>GRCg7b</code></li>
<li>Assembly and Gene set will be updated for Tropical clawed frog (Xenopus tropicalis): Xenopus tropicalis v9.1 to UCB Xtro 10.0</li>
</ul>
<p>– <a href="https://www.ensembl.info/2022/05/31/whats-coming-in-ensembl-release-107-ensembl-genomes-54/">Release notes for Ensembl 107</a></p>
</blockquote>
<p>All in all, this has been a really confusing adventure, but I <em>think</em> I learned something…</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-chicken-mitochondria" class="csl-entry" role="listitem">
Desjardins, Paul, and Réjean Morais. 1990. <span>“Sequence and Gene Organization of the Chicken Mitochondrial Genome: A Novel Gene Order in Higher Vertebrates.”</span> <em>Journal of Molecular Biology</em> 212 (4): 599–634. https://doi.org/<a href="https://doi.org/10.1016/0022-2836(90)90225-B">https://doi.org/10.1016/0022-2836(90)90225-B</a>.
</div>
<div id="ref-chicken-cells" class="csl-entry" role="listitem">
Feregrino, C, F Sacher, Parnas O, and P Tschopp. 2019. <span>“A Single-Cell Transcriptomic Atlas of the Developing Chicken Limb.”</span> <em>BMC Genomics</em>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Despite my earlier belief in this being a two-chicken conundrum!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script>
    // Remove background
    elements = document.querySelectorAll('[id=clean-collapse]').forEach(
        function(element) {
            element.classList.remove("callout-style-default");
        }
    )
    
    // Add arrow to front to signify dropdownyness
    arrow = "▶";
    elements = document.querySelectorAll('.callout-caption-container').forEach(
        function(element) {
            element.innerHTML = arrow + element.innerHTML;
        }
    )
</script>
<script src="https://giscus.app/client.js" data-repo="baileyandrew/blog" data-repo-id="R_kgDOInJwKg" data-category="Announcements" data-category-id="DIC_kwDOInJwKs4CTGOQ" data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark_protanopia" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script>
<!--
Assuming `_quarto.yml` has `navbar: pinned: true`,
this will make it so that the navbar scrolls with the rest of the website.
-->
<script>
    document.getElementById('quarto-header').classList.remove('fixed-top');
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>